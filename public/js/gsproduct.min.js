$(() => {
  function t(t, a) {
    $.ajax({
      url: 'http://127.0.0.1:3000/api/getgsproduct',
      data: { shopid: t, areaid: a },
      dataType: 'json',
      success: t => {
        let a = t.result,
          i = ''
        a.forEach(t => {
          i += `\n                    <li>\n                    <a href="http://item.m.jd.com/ware/view.action?wareId=1274360" class="item border-img">\n                            <div class="pic"><img\n                                    src="${
            t.productImg
          }"\n                                    style="width: 174px; height: 174px;"></div>\n                            <div class="title">${
            t.productName
          }</div>\n                            <div class="other">\n                                <div class="price">${
            t.productPrice
          }</div>\n                                <div class="btn">去凑单</div>\n                                <div class="clearfix"></div>\n                            </div>\n                        </a></li>\n                    \n                    `
        }),
          $('#container').html(i)
      }
    })
  }
  let a
  t(0, 0),
    $('.filter li').on('click', function() {
      if (((a = $(this).attr('data-id')), $('#shop').show(), !a))
        return $('#shop ul').html('<li class=""><a>全部价格</a></li>')
      $.ajax({
        url: 'http://127.0.0.1:3000/api/' + a,
        dataType: 'json',
        success: t => {
          let a = t.result,
            i = ''
          a.forEach(t => {
            i += `\n                    <li class="" data-id="${t.areaId ||
              t.shopId}"><a>${t.shopName || t.areaName}</a></li>`
          }),
            $('#shop ul').html(i)
        }
      })
    })
  let i = 0,
    s = 0
  $('#shop').on('click', 'li', function() {
    let e = $(this).attr('data-id'),
      d = $(this).text()
    'getgsshop' === a
      ? ((i = e), $(`[data-id='${a}'] a`).text(d))
      : a && ((s = e), $(`[data-id='${a}'] a`).text(d)),
      $('#shop').hide(),
      t(i, s)
  })
})
